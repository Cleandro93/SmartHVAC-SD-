{"version":3,"sources":["./src/app/main/device-details/device-details.page.html","./src/app/main/device-details/device-details.module.ts","./src/app/main/device-details/device-details.page.scss","./src/app/main/device-details/device-details.page.ts"],"names":[],"mappings":"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","file":"main-device-details-device-details-module-es2015.js","sourcesContent":["module.exports = \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button slot=\\\"start\\\" defaultHref=\\\"bluetooth\\\"></ion-back-button>\\n    </ion-buttons>\\n    <ion-title>deviceDetails</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content class=padding>\\n  <ion-card>\\n    <ion-card-header>\\n      {{ device.name || \\\"Unnamed\\\"}}\\n    </ion-card-header>\\n    <ion-card-content>\\n      ID: {{ device.id }}\\n    </ion-card-content>\\n  </ion-card>\\n\\n  <!--<ion-card>\\n    <ion-card-header>\\n      Services\\n    </ion-card-header>\\n    <ion-list>\\n      <ion-item *ngFor=\\\"let service of device.services\\\">\\n        <p>{{service}}</p>\\n        </ion-item>\\n    </ion-list>\\n  </ion-card>-->\\n\\n  <ion-card>\\n    <ion-card-header>\\n      Notification data\\n    </ion-card-header>\\n    <ion-list>\\n      <ion-item *ngFor=\\\"let data of sensorData\\\">\\n        <p>{{data}}</p>\\n        </ion-item>\\n    </ion-list>\\n  </ion-card>\\n\\n</ion-content>\\n\\n<ion-footer>\\n  <ion-toolbar>\\n    <p>{{ statusMessage }}</p>\\n  </ion-toolbar>\\n</ion-footer>\\n\"","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { DeviceDetailsPage } from './device-details.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: DeviceDetailsPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [DeviceDetailsPage]\n})\nexport class DeviceDetailsPageModule {}\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL21haW4vZGV2aWNlLWRldGFpbHMvZGV2aWNlLWRldGFpbHMucGFnZS5zY3NzIn0= */\"","import { Component, OnInit, NgZone } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { ToastController, AlertController } from '@ionic/angular';\nimport { BLE } from '@ionic-native/ble/ngx';\n\n@Component({\n  selector: 'app-device-details',\n  templateUrl: './device-details.page.html',\n  styleUrls: ['./device-details.page.scss'],\n})\nexport class DeviceDetailsPage implements OnInit {\n\n  device: any = {};\n  sensorData:Uint8Array;\n  statusMessage: string;\n\n  constructor(private route: ActivatedRoute,\n              private router: Router,\n              private ngZone: NgZone,\n              private toastCtrl: ToastController,\n              private ble: BLE,\n              public alertController: AlertController\n  ) { }\n\n  ngOnInit() {\n    //if (this.route.snapshot.data['special']){\n      let passDevice = this.route.snapshot.data['special'];\n\n      this.setStatus('Connecting to ' + passDevice.name || passDevice.id);\n\n      this.ble.connect(passDevice.id).subscribe(\n        device => this.onConnected(passDevice),\n        device => this.onDeviceDisconnected(passDevice)\n      );\n\n    //}\n  }\n\n  onConnected(device){\n    //this.ngZone.run(() => {\n    this.device = device;\n    this.setStatus('Connected to ' + (device.name || device.id));\n\n    this.ble.startNotification(this.device.id, \"D0AF\", \"6B7B\").subscribe(\n        data => this.onSensorsData(data),\n        error => this.presentAlert('Unexpected Error', error)\n    )\n    //})\n  }\n\nonSensorsData(buffer:ArrayBuffer){\n  var data = new Uint8Array(buffer);\n  console.log(\"***  DATA NOTIFICATION  *** \", data);\n  this.ngZone.run(() =>{\n    this.sensorData = data;\n  });\n}\n onDeviceDisconnected(device){\n    let toast = this.toastCtrl.create({\n      message: 'The device unexpectedly disconnected.',\n      duration: 3000,\n      position: 'middle'\n    });\n  }\n\n  async presentAlert(header, message) {\n    const alert = await this.alertController.create({\n      header: header,\n      subHeader: 'Subtitle',\n      message: message,\n      buttons: ['OK']\n    });\n\n    await alert.present();\n  }\n\n\n  setStatus(message){\n    console.log(message);\n    this.ngZone.run(() => {\n      this.statusMessage = message;\n    });\n  }\n\n  ionViewWillLeave(){\n    this.ble.disconnect(this.device.id).then(\n      ()=>console.log('Disconnected'+JSON.stringify(this.device)),\n      ()=>console.log('ERROR disconnecting '+JSON.stringify(this.device))\n    )\n  }\n\n}\n"],"sourceRoot":""}